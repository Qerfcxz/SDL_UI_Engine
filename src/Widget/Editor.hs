{-# OPTIONS_GHC -Wno-unrecognised-pragmas #-}
{-# HLINT ignore "Use camelCase" #-}
module Widget.Editor where
import Editor.Core
import Editor.Cursor
import Editor.Select
import Other.Error
import Other.Get
import Widget.Create
import Type
import qualified Data.Foldable as DF
import qualified Data.IntMap.Strict as DIS
import qualified Data.Sequence as DSeq
import qualified Data.Set as DSet
import qualified Data.Text as DT
import qualified Data.Word as DW
import qualified Foreign.C.Types as FCT
import qualified Foreign.Marshal.Alloc as FMA
import qualified Foreign.Ptr as FP
import qualified Foreign.Storable as FS
import qualified GHC.Stack as GS
import qualified SDL.Raw.Event as SRE
import qualified SDL.Raw.Font as SRF
import qualified SDL.Raw.Types as SRT

create_editor_trigger::(Engine a->Event->Id)->DSeq.Seq Int->DSeq.Seq (DSeq.Seq Int)->Engine a->IO (Engine a)
create_editor_trigger next_id seq_id seq_seq_id engine=let (combined_id,single_id)=get_widget_id seq_id engine in create_widget combined_id single_id (Leaf_widget_request next_id (Io_trigger_request (create_editor_trigger_a seq_seq_id))) engine

create_editor_trigger_a::DSeq.Seq (DSeq.Seq Int)->Event->Engine a->IO (Engine a)
create_editor_trigger_a seq_seq_id event (Engine widget window window_map request key main_id start_id count_id time)=do
    new_widget<-DF.foldlM (\this_widget this_seq_id->create_editor_trigger_b this_seq_id start_id window event this_widget) widget seq_seq_id
    return (Engine new_widget window window_map request key main_id start_id count_id time)

create_editor_trigger_b::GS.HasCallStack=>DSeq.Seq Int->Int->DIS.IntMap Window->Event->DIS.IntMap (DIS.IntMap (Combined_widget a))->IO (DIS.IntMap (DIS.IntMap (Combined_widget a)))
create_editor_trigger_b seq_id start_id window event widget=let (combined_id,single_id)=get_widget_id_widget seq_id start_id widget in let combined_widget=error_lookup_lookup "create_editor_trigger_b: error 1" "create_editor_trigger_b: error 2" combined_id single_id widget in case combined_widget of
    Leaf_widget _ (Editor window_id _ _ _ _ font_size _ path _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _)->case get_widget_widget path start_id widget of
        Leaf_widget _ (Block_font _ _ _ _ _ font)->case error_lookup "create_editor_trigger_b: error 3" font_size font of
            (this_font,_,intmap_texture)->do
                (maybe_intmap_texture,maybe_new_combined_widget)<-create_editor_trigger_c (get_renderer_window window_id window) event this_font intmap_texture combined_widget
                case maybe_intmap_texture of
                    Nothing->case maybe_new_combined_widget of
                        Nothing->return widget
                        Just new_combined_widget->return (error_replace_replace "create_editor_trigger_b: error 4" "create_editor_trigger_b: error 5" combined_id single_id new_combined_widget widget)
                    Just new_intmap_texture->case maybe_new_combined_widget of
                        Nothing->let (font_combined_id,font_single_id)=get_widget_id_widget path start_id widget in error_update_update_io "create_editor_trigger_b: error 6" "create_editor_trigger_b: error 7" font_combined_id font_single_id (create_editor_trigger_d font_size new_intmap_texture) widget
                        Just new_combined_widget->do
                            new_widget<-let (font_combined_id,font_single_id)=get_widget_id_widget path start_id widget in error_update_update_io "create_editor_trigger_b: error 8" "create_editor_trigger_b: error 9" font_combined_id font_single_id (create_editor_trigger_d font_size new_intmap_texture) widget
                            return (error_replace_replace "create_editor_trigger_b: error 10" "create_editor_trigger_b: error 11" combined_id single_id new_combined_widget new_widget)
        _->error "create_editor_trigger_b: error 12"
    _->error "create_editor_trigger_b: error 13"

create_editor_trigger_c::GS.HasCallStack=>SRT.Renderer->Event->FP.Ptr SRF.Font->DIS.IntMap (SRT.Texture,DIS.IntMap (Int,FCT.CInt),FCT.CInt,DW.Word8,DW.Word8,DW.Word8,DW.Word8)->Combined_widget a->IO (Maybe (DIS.IntMap (SRT.Texture,DIS.IntMap (Int,FCT.CInt),FCT.CInt,DW.Word8,DW.Word8,DW.Word8,DW.Word8)),Maybe (Combined_widget a))
create_editor_trigger_c renderer event font intmap_texture (Leaf_widget next_id (Editor window_id block_number row_number row design_font_size font_size render path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding))=case editor_binding of
    Empty_editor_binding->return (Nothing,Nothing)
    Editor_binding trace wheel up_press down_press start_press end_press min_trace_press max_trace_press cursor_left_press cursor_right_press cursor_up_press cursor_down_press cursor_start_press cursor_end_press cursor_paragraph_start_press cursor_paragraph_end_press cursor_row_start_press cursor_row_end_press copy_press min_paste_press max_paste_press min_cut_press max_cut_press min_select_all_press max_select_all_press select_start_press select_end_press min_select_paragraph_all_press max_select_paragraph_all_press select_paragraph_start_press select_paragraph_end_press min_select_row_all_press max_select_row_all_press select_row_start_press select_row_end_press select_left_press select_right_press select_up_press select_down_press min_select_swap_press max_select_swap_press min_backspace_press max_backspace_press min_delete_press max_delete_press min_enter_press max_enter_press exit_press up_click down_click->case event of
        At this_window_id action->if window_id==this_window_id
            then case action of
                Input text->if DT.null text then return (Nothing,Nothing) else do
                    something<-text_input renderer block_number typesetting text_red text_green text_blue text_alpha font block_width (from_text text DSeq.empty) cursor seq_seq_char intmap_texture
                    case something of
                        Nothing->return (Nothing,Nothing)
                        Just (cursor_row,new_cursor,new_seq_seq_char,maybe_intmap_texture)->if trace then return (maybe_intmap_texture,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else min (max 0 (DSeq.length new_seq_seq_char-row_number)) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor new_seq_seq_char editor_binding))) else return (maybe_intmap_texture,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor new_seq_seq_char editor_binding)))
                Wheel delta_y->if wheel
                    then case cursor of
                        Cursor_none->return (Nothing,Nothing)
                        _->let new_row=max 0 (min (DSeq.length seq_seq_char-row_number) (row-delta_y)) in if row==new_row then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number new_row design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                    else return (Nothing,Nothing)
                Press press _ key->if DSet.member (press,key) up_press
                    then if 0<row then return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (row-1) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding))) else return (Nothing,Nothing)
                    else if DSet.member (press,key) down_press
                        then if row<DSeq.length seq_seq_char-row_number then return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (row+1) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding))) else return (Nothing,Nothing)
                        else if DSet.member (press,key) start_press
                            then if row==0 then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number 0 design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                            else if DSet.member (press,key) end_press
                                then let new_row=max 0 (DSeq.length seq_seq_char-row_number) in if row==new_row then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number new_row design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                else if DSet.member (press,key) min_trace_press
                                    then case get_cursor_row cursor of
                                        Nothing->return (Nothing,Nothing)
                                        Just cursor_row->let new_row=min (max 0 (DSeq.length seq_seq_char-row_number)) cursor_row in if new_row==row then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number new_row design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                    else if DSet.member (press,key) max_trace_press
                                        then case get_cursor_row cursor of
                                            Nothing->return (Nothing,Nothing)
                                            Just cursor_row->let new_row=max 0 (cursor_row+1-row_number) in if new_row==row then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number new_row design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                        else if DSet.member (press,key) cursor_left_press
                                            then case cursor_left block_number typesetting seq_seq_char cursor of
                                                Nothing->return (Nothing,Nothing)
                                                Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number cursor_row design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                            else if DSet.member (press,key) cursor_right_press
                                                then case cursor_right (DSeq.length seq_seq_char-1) block_number typesetting seq_seq_char cursor of
                                                    Nothing->return (Nothing,Nothing)
                                                    Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (cursor_row+1-row_number) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                    Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                else if DSet.member (press,key) cursor_up_press
                                                    then case cursor_up block_number typesetting seq_seq_char cursor of
                                                        Nothing->return (Nothing,Nothing)
                                                        Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number cursor_row design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                        Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                    else if DSet.member (press,key) cursor_down_press
                                                        then case cursor_down (DSeq.length seq_seq_char-1) block_number typesetting seq_seq_char cursor of
                                                            Nothing->return (Nothing,Nothing)
                                                            Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (cursor_row+1-row_number) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                            Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                        else if DSet.member (press,key) cursor_start_press
                                                            then case cursor_min block_number typesetting seq_seq_char cursor of
                                                                Nothing->if row==0 then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number 0 design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                Just new_cursor->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number 0 design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                            else if DSet.member (press,key) cursor_end_press
                                                                then let max_row=DSeq.length seq_seq_char-1 in case cursor_max max_row block_number typesetting seq_seq_char cursor of
                                                                    Nothing->if row==max_row then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (max 0 (max_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                    Just new_cursor->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (max 0 (max_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                else if DSet.member (press,key) cursor_paragraph_start_press
                                                                    then case cursor_paragraph_min block_number typesetting seq_seq_char cursor of
                                                                        Nothing->return (Nothing,Nothing)
                                                                        Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                        Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                    else if DSet.member (press,key) cursor_paragraph_end_press
                                                                        then case cursor_paragraph_max block_number typesetting seq_seq_char cursor of
                                                                            Nothing->return (Nothing,Nothing)
                                                                            Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                            Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                        else if DSet.member (press,key) cursor_row_start_press
                                                                            then case cursor_row_min block_number typesetting seq_seq_char cursor of
                                                                                Nothing->return (Nothing,Nothing)
                                                                                Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                            else if DSet.member (press,key) cursor_row_end_press
                                                                                then case cursor_row_max block_number typesetting seq_seq_char cursor of
                                                                                    Nothing->return (Nothing,Nothing)
                                                                                    Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                    Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                                else if DSet.member (press,key) copy_press
                                                                                    then do
                                                                                        copy seq_seq_char cursor
                                                                                        return (Nothing,Nothing)
                                                                                    else if DSet.member (press,key) min_paste_press
                                                                                        then do
                                                                                            something<-paste renderer block_number typesetting text_red text_green text_blue text_alpha font block_width cursor seq_seq_char intmap_texture
                                                                                            case something of
                                                                                                Nothing->return (Nothing,Nothing)
                                                                                                Just (cursor_row,new_cursor,new_seq_seq_char,maybe_intmap_texture)->return (maybe_intmap_texture,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else min (max 0 (DSeq.length new_seq_seq_char-row_number)) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor new_seq_seq_char editor_binding)))
                                                                                        else if DSet.member (press,key) max_paste_press
                                                                                            then do
                                                                                                something<-paste renderer block_number typesetting text_red text_green text_blue text_alpha font block_width cursor seq_seq_char intmap_texture
                                                                                                case something of
                                                                                                    Nothing->return (Nothing,Nothing)
                                                                                                    Just (cursor_row,new_cursor,new_seq_seq_char,maybe_intmap_texture)->return (maybe_intmap_texture,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor new_seq_seq_char editor_binding)))
                                                                                            else if DSet.member (press,key) min_cut_press
                                                                                                then do
                                                                                                    copy seq_seq_char cursor
                                                                                                    case cut block_number typesetting cursor seq_seq_char of
                                                                                                        Nothing->return (Nothing,Nothing)
                                                                                                        Just (cursor_row,new_cursor,new_seq_seq_char)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then min (max 0 (DSeq.length new_seq_seq_char-row_number)) row else min (max 0 (DSeq.length new_seq_seq_char-row_number)) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor new_seq_seq_char editor_binding)))
                                                                                                else if DSet.member (press,key) max_cut_press
                                                                                                    then do
                                                                                                        copy seq_seq_char cursor
                                                                                                        case cut block_number typesetting cursor seq_seq_char of
                                                                                                            Nothing->return (Nothing,Nothing)
                                                                                                            Just (cursor_row,new_cursor,new_seq_seq_char)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then min (max 0 (DSeq.length new_seq_seq_char-row_number)) row else max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor new_seq_seq_char editor_binding)))
                                                                                                    else if DSet.member (press,key) min_select_all_press
                                                                                                        then case min_select_all seq_seq_char typesetting block_number (DSeq.length seq_seq_char-1) cursor of
                                                                                                            Nothing->if row==0 then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number 0 design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                            Just new_cursor->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number 0 design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                                                        else if DSet.member (press,key) max_select_all_press
                                                                                                            then let max_row=DSeq.length seq_seq_char-1 in case max_select_all seq_seq_char typesetting block_number max_row cursor of
                                                                                                                Nothing->if row==max_row then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (max 0 (max_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                Just new_cursor->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (max 0 (max_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                                                            else if DSet.member (press,key) select_start_press
                                                                                                                then case select_start seq_seq_char typesetting block_number cursor of
                                                                                                                    Nothing->if row==0 then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number 0 design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                    Just new_cursor->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number 0 design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                                                                else if DSet.member (press,key) select_end_press
                                                                                                                    then let max_row=DSeq.length seq_seq_char-1 in case select_end seq_seq_char typesetting block_number max_row cursor of
                                                                                                                        Nothing->if row==max_row then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (max 0 (max_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                        Just new_cursor->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (max 0 (max_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                                                                    else if DSet.member (press,key) min_select_paragraph_all_press
                                                                                                                        then case min_select_paragraph_all seq_seq_char typesetting block_number cursor of
                                                                                                                            Nothing->return (Nothing,Nothing)
                                                                                                                            Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                            Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                                                                        else if DSet.member (press,key) max_select_paragraph_all_press
                                                                                                                            then case max_select_paragraph_all seq_seq_char typesetting block_number cursor of
                                                                                                                                Nothing->return (Nothing,Nothing)
                                                                                                                                Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                                Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                                                                            else if DSet.member (press,key) select_paragraph_start_press
                                                                                                                                then case select_paragraph_start seq_seq_char typesetting block_number cursor of
                                                                                                                                    Nothing->return (Nothing,Nothing)
                                                                                                                                    Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                                    Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                                                                                else if DSet.member (press,key) select_paragraph_end_press
                                                                                                                                    then case select_paragraph_end seq_seq_char typesetting block_number cursor of
                                                                                                                                        Nothing->return (Nothing,Nothing)
                                                                                                                                        Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                                        Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                                                                                    else if DSet.member (press,key) min_select_row_all_press
                                                                                                                                        then case min_select_row_all seq_seq_char typesetting block_number cursor of
                                                                                                                                            Nothing->return (Nothing,Nothing)
                                                                                                                                            Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                                            Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                                                                                        else if DSet.member (press,key) max_select_row_all_press
                                                                                                                                            then case max_select_row_all seq_seq_char typesetting block_number cursor of
                                                                                                                                                Nothing->return (Nothing,Nothing)
                                                                                                                                                Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                                                Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                                                                                            else if DSet.member (press,key) select_row_start_press
                                                                                                                                                then case select_row_start seq_seq_char typesetting block_number cursor of
                                                                                                                                                    Nothing->return (Nothing,Nothing)
                                                                                                                                                    Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                                                    Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                                                                                                else if DSet.member (press,key) select_row_end_press
                                                                                                                                                    then case select_row_end seq_seq_char typesetting block_number cursor of
                                                                                                                                                        Nothing->return (Nothing,Nothing)
                                                                                                                                                        Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                                                        Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                                                                                                    else if DSet.member (press,key) select_left_press
                                                                                                                                                        then case select_left seq_seq_char typesetting block_number cursor of
                                                                                                                                                            Nothing->return (Nothing,Nothing)
                                                                                                                                                            Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                                                            Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                                                                                                        else if DSet.member (press,key) select_right_press
                                                                                                                                                            then case select_right seq_seq_char typesetting block_number (DSeq.length seq_seq_char-1) cursor of
                                                                                                                                                                Nothing->return (Nothing,Nothing)
                                                                                                                                                                Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                                                                Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                                                                                                            else if DSet.member (press,key) select_up_press
                                                                                                                                                                then case select_up seq_seq_char typesetting block_number cursor of
                                                                                                                                                                    Nothing->return (Nothing,Nothing)
                                                                                                                                                                    Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                                                                    Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                                                                                                                else if DSet.member (press,key) select_down_press
                                                                                                                                                                    then case select_down seq_seq_char typesetting block_number (DSeq.length seq_seq_char-1) cursor of
                                                                                                                                                                        Nothing->return (Nothing,Nothing)
                                                                                                                                                                        Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                                                                        Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                                                                                                                    else if DSet.member (press,key) min_select_swap_press
                                                                                                                                                                        then case select_swap cursor of
                                                                                                                                                                            Nothing->return (Nothing,Nothing)
                                                                                                                                                                            Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                                                                            Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                                                                                                                        else if DSet.member (press,key) max_select_swap_press
                                                                                                                                                                            then case select_swap cursor of
                                                                                                                                                                                Nothing->return (Nothing,Nothing)
                                                                                                                                                                                Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                                                                                Just (cursor_row,Just new_cursor)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor seq_seq_char editor_binding)))
                                                                                                                                                                            else if DSet.member (press,key) min_backspace_press
                                                                                                                                                                                then case backspace block_number typesetting cursor seq_seq_char of
                                                                                                                                                                                    Nothing->return (Nothing,Nothing)
                                                                                                                                                                                    Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number 0 design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                                                                                    Just (cursor_row,Just (new_cursor,new_seq_seq_char))->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then min (max 0 (DSeq.length new_seq_seq_char-row_number)) row else min (max 0 (DSeq.length new_seq_seq_char-row_number)) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor new_seq_seq_char editor_binding)))
                                                                                                                                                                                else if DSet.member (press,key) max_backspace_press
                                                                                                                                                                                    then case backspace block_number typesetting cursor seq_seq_char of
                                                                                                                                                                                        Nothing->return (Nothing,Nothing)
                                                                                                                                                                                        Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number 0 design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                                                                                        Just (cursor_row,Just (new_cursor,new_seq_seq_char))->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then min (max 0 (DSeq.length new_seq_seq_char-row_number)) row else max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor new_seq_seq_char editor_binding)))
                                                                                                                                                                                    else if DSet.member (press,key) min_delete_press
                                                                                                                                                                                        then case delete block_number (DSeq.length seq_seq_char-1) typesetting cursor seq_seq_char of
                                                                                                                                                                                            Nothing->return (Nothing,Nothing)
                                                                                                                                                                                            Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                                                                                            Just (cursor_row,Just (new_cursor,new_seq_seq_char))->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then min (max 0 (DSeq.length new_seq_seq_char-row_number)) row else min (max 0 (DSeq.length new_seq_seq_char-row_number)) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor new_seq_seq_char editor_binding)))
                                                                                                                                                                                        else if DSet.member (press,key) max_delete_press
                                                                                                                                                                                            then case delete block_number (DSeq.length seq_seq_char-1) typesetting cursor seq_seq_char of
                                                                                                                                                                                                Nothing->return (Nothing,Nothing)
                                                                                                                                                                                                Just (cursor_row,Nothing)->if row<=cursor_row&&cursor_row<row+row_number then return (Nothing,Nothing) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down cursor seq_seq_char editor_binding)))
                                                                                                                                                                                                Just (cursor_row,Just (new_cursor,new_seq_seq_char))->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then min (max 0 (DSeq.length new_seq_seq_char-row_number)) row else max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor new_seq_seq_char editor_binding)))
                                                                                                                                                                                            else if DSet.member (press,key) min_enter_press
                                                                                                                                                                                                then case enter block_number typesetting cursor seq_seq_char of
                                                                                                                                                                                                    Nothing->return (Nothing,Nothing)
                                                                                                                                                                                                    Just (cursor_row,new_cursor,new_seq_seq_char)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else min (DSeq.length seq_seq_char-row_number) cursor_row) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor new_seq_seq_char editor_binding)))
                                                                                                                                                                                                else if DSet.member (press,key) max_enter_press
                                                                                                                                                                                                    then case enter block_number typesetting cursor seq_seq_char of
                                                                                                                                                                                                        Nothing->return (Nothing,Nothing)
                                                                                                                                                                                                        Just (cursor_row,new_cursor,new_seq_seq_char)->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number (if row<=cursor_row&&cursor_row<row+row_number then row else max 0 (cursor_row+1-row_number)) design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down new_cursor new_seq_seq_char editor_binding)))
                                                                                                                                                                                                    else if DSet.member (press,key) exit_press
                                                                                                                                                                                                        then case cursor of
                                                                                                                                                                                                            Cursor_none->return (Nothing,Nothing)
                                                                                                                                                                                                            _->return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number row design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down Cursor_none seq_seq_char editor_binding)))
                                                                                                                                                                                                        else return (Nothing,Nothing)
                Click click mouse click_x click_y->case cursor of
                    Cursor_none->if DSet.member (click,mouse) down_click&&left<=click_x&&click_x<=right&&up<=click_y&&click_y<=down
                        then do
                            FMA.alloca $ \rect->do
                                FS.poke rect (SRT.Rect ime_left ime_up (ime_right-ime_left) (ime_down-ime_up))
                                SRE.setTextInputRect rect
                            let (cursor_row,cursor_block,cursor_char,cursor_click)=to_cursor block_number (min row_number (DSeq.length seq_seq_char-row)) row typesetting click_x click_y font_height block_width delta_height x y seq_seq_char in return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number row design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down (Cursor_single True cursor_row cursor_block cursor_char cursor_click) seq_seq_char editor_binding)))
                        else return (Nothing,Nothing)
                    Cursor_single _ cursor_row cursor_block cursor_char cursor_click->if DSet.member (click,mouse) up_click then if left<=click_x&&click_x<=right&&up<=click_y&&click_y<=down then let (new_cursor_row,new_cursor_block,new_cursor_char,new_cursor_click)=to_cursor block_number (min row_number (DSeq.length seq_seq_char-row)) row typesetting click_x click_y font_height block_width delta_height x y seq_seq_char in if cursor_row==new_cursor_row&&cursor_block==new_cursor_block then return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number row design_font_size font_size render path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down (Cursor_single False cursor_row cursor_block cursor_char cursor_click) seq_seq_char editor_binding))) else if (cursor_row,cursor_block)<(new_cursor_row,new_cursor_block) then return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number row design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down (Cursor_double False False cursor_row cursor_block cursor_char cursor_click new_cursor_row new_cursor_block new_cursor_char new_cursor_click) seq_seq_char editor_binding))) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number row design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down (Cursor_double False True new_cursor_row new_cursor_block new_cursor_char new_cursor_click cursor_row cursor_block cursor_char cursor_click) seq_seq_char editor_binding))) else return (Nothing,Nothing) else if DSet.member (click,mouse) down_click then if left<=click_x&&click_x<=right&&up<=click_y&&click_y<=down then let (new_cursor_row,new_cursor_block,new_cursor_char,new_cursor_click)=to_cursor block_number (min row_number (DSeq.length seq_seq_char-row)) row typesetting click_x click_y font_height block_width delta_height x y seq_seq_char in return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number row design_font_size font_size (not (cursor_row==new_cursor_row&&cursor_block==new_cursor_block)) path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down (Cursor_single True new_cursor_row new_cursor_block new_cursor_char new_cursor_click) seq_seq_char editor_binding))) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number row design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down Cursor_none seq_seq_char editor_binding))) else return (Nothing,Nothing)
                    Cursor_double _ cursor_where cursor_row_start cursor_block_start cursor_char_start cursor_click_start cursor_row_end cursor_block_end cursor_char_end cursor_click_end->if DSet.member (click,mouse) up_click then return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number row design_font_size font_size render path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down (Cursor_double False cursor_where cursor_row_start cursor_block_start cursor_char_start cursor_click_start cursor_row_end cursor_block_end cursor_char_end cursor_click_end) seq_seq_char editor_binding))) else if DSet.member (click,mouse) down_click then if left<=click_x&&click_x<=right&&up<=click_y&&click_y<=down then let (cursor_row,cursor_block,cursor_char,cursor_click)=to_cursor block_number (min row_number (DSeq.length seq_seq_char-row)) row typesetting click_x click_y font_height block_width delta_height x y seq_seq_char in return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number row design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down (Cursor_single True cursor_row cursor_block cursor_char cursor_click) seq_seq_char editor_binding))) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number row design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down Cursor_none seq_seq_char editor_binding))) else return (Nothing,Nothing)
                Move move_x move_y _ _->case cursor of
                    Cursor_none->return (Nothing,Nothing)
                    Cursor_single cursor_press cursor_row cursor_block cursor_char cursor_click->if cursor_press then let (new_cursor_row,new_cursor_block,new_cursor_char,new_cursor_click)=to_cursor block_number (min row_number (DSeq.length seq_seq_char-row)) row typesetting move_x move_y font_height block_width delta_height x y seq_seq_char in if cursor_row==new_cursor_row&&cursor_block==new_cursor_block then return (Nothing,Nothing) else if (cursor_row,cursor_block)<(new_cursor_row,new_cursor_block) then return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number row design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down (Cursor_double True False cursor_row cursor_block cursor_char cursor_click new_cursor_row new_cursor_block new_cursor_char new_cursor_click) seq_seq_char editor_binding))) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number row design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down (Cursor_double True True new_cursor_row new_cursor_block new_cursor_char new_cursor_click cursor_row cursor_block cursor_char cursor_click) seq_seq_char editor_binding))) else return (Nothing,Nothing)
                    Cursor_double cursor_press cursor_where cursor_row_start cursor_block_start cursor_char_start cursor_click_start cursor_row_end cursor_block_end cursor_char_end cursor_click_end->if cursor_press then let (cursor_row,cursor_block,cursor_char,cursor_click)=if cursor_where then (cursor_row_end,cursor_block_end,cursor_char_end,cursor_click_end) else (cursor_row_start,cursor_block_start,cursor_char_start,cursor_click_start) in let (new_cursor_row,new_cursor_block,new_cursor_char,new_cursor_click)=to_cursor block_number (min row_number (DSeq.length seq_seq_char-row)) row typesetting move_x move_y font_height block_width delta_height x y seq_seq_char in if cursor_row==new_cursor_row&&cursor_block==new_cursor_block then return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number row design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down (Cursor_single True cursor_row cursor_block cursor_char cursor_click) seq_seq_char editor_binding))) else if (cursor_row,cursor_block)<(new_cursor_row,new_cursor_block) then return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number row design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down (Cursor_double True False cursor_row cursor_block cursor_char cursor_click new_cursor_row new_cursor_block new_cursor_char new_cursor_click) seq_seq_char editor_binding))) else return (Nothing,Just (Leaf_widget next_id (Editor window_id block_number row_number row design_font_size font_size True path find typesetting text_red text_green text_blue text_alpha cursor_red cursor_green cursor_blue cursor_alpha select_red select_green select_blue select_alpha height design_block_width design_delta_height design_x design_y design_extra_width design_extra_height design_ime_left design_ime_right design_ime_up design_ime_down font_height block_width delta_height x y left right up down ime_left ime_right ime_up ime_down (Cursor_double True True new_cursor_row new_cursor_block new_cursor_char new_cursor_click cursor_row cursor_block cursor_char cursor_click) seq_seq_char editor_binding))) else return (Nothing,Nothing)
                _->return (Nothing,Nothing)
            else return (Nothing,Nothing)
        _->return (Nothing,Nothing)
create_editor_trigger_c _ _ _ _ _=error "create_editor_trigger_c: error 1"

create_editor_trigger_d::GS.HasCallStack=>Int->DIS.IntMap (SRT.Texture,DIS.IntMap (Int,FCT.CInt),FCT.CInt,DW.Word8,DW.Word8,DW.Word8,DW.Word8)->Combined_widget a->IO (Combined_widget a)
create_editor_trigger_d size intmap_texture (Leaf_widget next_id (Block_font window_id red green blue alpha font))=return (Leaf_widget next_id (Block_font window_id red green blue alpha (DIS.adjust (\(this_font,height,_)->(this_font,height,intmap_texture)) size font)))
create_editor_trigger_d _ _ _=error "create_editor_trigger_d: error 1"